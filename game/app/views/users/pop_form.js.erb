// app/views/users/pop_form.js.erb
<%# j is to be able to include javascript %>
$('#form_dialog').html("<%= j render 'form_dialog' %>");
$('#form_dialog').dialog({
  title: 'Edit User',
  modal: true,
  width: 'auto',
  buttons: {
    "Save": function() {
        var username = $('#username-field').val();
        var password = $('#password-field').val();
        
        <%# Submit the form via AJAX %>
        var form = $('#form_dialog form');
        var actionURL = "<%= access_profile_path %>";

        $.ajax ({
            type: 'POST',
            url: actionURL,
            data: {
                username: username,
                password: password
            },
            success: function(data) {
                $("profile").html(data);
            },
            error: function() {
              alert("Invalid username or password")
            }
        });
    },
    "Cancel": function() {
      $(this).dialog('close');
    }
  },
  close: function() {
    $(this).dialog('destroy');
  }
});
